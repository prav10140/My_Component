<!DOCTYPE html>
<html>
  <head>
    <title>Live CNN Prediction</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  </head>
  <body style="text-align:center; background:#111; color:white;">
    <h2>ðŸ“· Live CNN Prediction</h2>
    <div id="result">Waiting...</div>

    <script>
      let video;
      const vercelAPI = "https://YOUR_VERCEL_APP_NAME.vercel.app/api/predict";

      function setup() {
        createCanvas(128, 128);
        video = createCapture(VIDEO);
        video.size(128, 128);
        video.hide();
        frameRate(1); // 1 FPS to limit load
      }

      async function draw() {
        image(video, 0, 0, 128, 128);
        const base64Img = document.querySelector("canvas").toDataURL("image/png");

        try {
          const res = await fetch(vercelAPI, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ image: base64Img })
          });
          const data = await res.json();
          document.getElementById("result").innerText = "ðŸ”® " + (data.label || data.error);
        } catch (err) {
          document.getElementById("result").innerText = "Error: " + err;
        }
      }
    </script>
  </body>
</html>
